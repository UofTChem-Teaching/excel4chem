<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Math, Stats, and Programming | Excel for General Chemistry</title>
  <meta name="description" content="This is a prelimary book aimed to help undergraduate chemistry students learn Micorsoft Excel" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Math, Stats, and Programming | Excel for General Chemistry" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a prelimary book aimed to help undergraduate chemistry students learn Micorsoft Excel" />
  <meta name="github-repo" content="UofTChem-Teaching/excel4chem" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Math, Stats, and Programming | Excel for General Chemistry" />
  
  <meta name="twitter:description" content="This is a prelimary book aimed to help undergraduate chemistry students learn Micorsoft Excel" />
  

<meta name="author" content="David Hall, David Liu, and Jessica D’eon" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling.html"/>
<link rel="next" href="data-visualization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#providing-feedback"><i class="fa fa-check"></i>Providing Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors"><i class="fa fa-check"></i>Authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowlegements"><i class="fa fa-check"></i>Acknowlegements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#ozone-is-not-our-friend"><i class="fa fa-check"></i><b>1.1</b> Ozone is Not Our Friend</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#atmospheric-concentration-units"><i class="fa fa-check"></i><b>1.2</b> Atmospheric Concentration Units</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="capabilities.html"><a href="capabilities.html"><i class="fa fa-check"></i><b>2</b> Getting Setup for Success</a>
<ul>
<li class="chapter" data-level="2.1" data-path="capabilities.html"><a href="capabilities.html#accessing-the-microsoft-office-suite-of-software"><i class="fa fa-check"></i><b>2.1</b> Accessing the Microsoft Office Suite of Software</a></li>
<li class="chapter" data-level="2.2" data-path="capabilities.html"><a href="capabilities.html#managing-your-files"><i class="fa fa-check"></i><b>2.2</b> Managing your Files</a></li>
<li class="chapter" data-level="2.3" data-path="capabilities.html"><a href="capabilities.html#creating-professional-documents"><i class="fa fa-check"></i><b>2.3</b> Creating Professional Documents</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="capabilities.html"><a href="capabilities.html#adding-an-excel-graph-to-a-word-document"><i class="fa fa-check"></i><b>2.3.1</b> Adding an Excel Graph to a Word Document</a></li>
<li class="chapter" data-level="2.3.2" data-path="capabilities.html"><a href="capabilities.html#adding-images-to-a-word-document"><i class="fa fa-check"></i><b>2.3.2</b> Adding Images to a Word Document</a></li>
<li class="chapter" data-level="2.3.3" data-path="capabilities.html"><a href="capabilities.html#creating-a-pdf-from-a-word-document"><i class="fa fa-check"></i><b>2.3.3</b> Creating a PDF from a Word Document</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#opening-a-csv-file"><i class="fa fa-check"></i><b>3.1</b> Opening a CSV file</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-discovery-and-cell-formatting"><i class="fa fa-check"></i><b>3.2</b> Data Discovery and Cell Formatting</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#data-cleaning"><i class="fa fa-check"></i><b>3.3</b> Data Cleaning</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="math-stats-and-programming.html"><a href="math-stats-and-programming.html"><i class="fa fa-check"></i><b>4</b> Math, Stats, and Programming</a>
<ul>
<li class="chapter" data-level="4.1" data-path="math-stats-and-programming.html"><a href="math-stats-and-programming.html#mathematical-operations"><i class="fa fa-check"></i><b>4.1</b> Mathematical Operations</a></li>
<li class="chapter" data-level="4.2" data-path="math-stats-and-programming.html"><a href="math-stats-and-programming.html#cell-referencing"><i class="fa fa-check"></i><b>4.2</b> Cell Referencing</a></li>
<li class="chapter" data-level="4.3" data-path="math-stats-and-programming.html"><a href="math-stats-and-programming.html#spreadsheet-organization"><i class="fa fa-check"></i><b>4.3</b> Spreadsheet Organization</a></li>
<li class="chapter" data-level="4.4" data-path="math-stats-and-programming.html"><a href="math-stats-and-programming.html#simple-statistical-functions"><i class="fa fa-check"></i><b>4.4</b> Simple Statistical Functions</a></li>
<li class="chapter" data-level="4.5" data-path="math-stats-and-programming.html"><a href="math-stats-and-programming.html#if-statements"><i class="fa fa-check"></i><b>4.5</b> If Statements</a></li>
<li class="chapter" data-level="4.6" data-path="math-stats-and-programming.html"><a href="math-stats-and-programming.html#sum-and-count-functions"><i class="fa fa-check"></i><b>4.6</b> SUM and COUNT Functions</a></li>
<li class="chapter" data-level="4.7" data-path="math-stats-and-programming.html"><a href="math-stats-and-programming.html#slope-trendline-and-r2-functions"><i class="fa fa-check"></i><b>4.7</b> SLOPE, TRENDLINE and R<sup>2</sup> Functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-visualization.html"><a href="data-visualization.html#creating-a-scatterplot"><i class="fa fa-check"></i><b>5.1</b> Creating a Scatterplot</a></li>
<li class="chapter" data-level="5.2" data-path="data-visualization.html"><a href="data-visualization.html#changing-chart-type-or-design"><i class="fa fa-check"></i><b>5.2</b> Changing Chart Type or Design</a></li>
<li class="chapter" data-level="5.3" data-path="data-visualization.html"><a href="data-visualization.html#adding-axis-labels-and-a-chart-title"><i class="fa fa-check"></i><b>5.3</b> Adding Axis Labels and a Chart Title</a></li>
<li class="chapter" data-level="5.4" data-path="data-visualization.html"><a href="data-visualization.html#formatting-axis-labels"><i class="fa fa-check"></i><b>5.4</b> Formatting Axis Labels</a></li>
<li class="chapter" data-level="5.5" data-path="data-visualization.html"><a href="data-visualization.html#adding-a-linear-regression-line"><i class="fa fa-check"></i><b>5.5</b> Adding a Linear Regression Line</a></li>
<li class="chapter" data-level="5.6" data-path="data-visualization.html"><a href="data-visualization.html#adding-a-dataseries-to-an-existing-plot"><i class="fa fa-check"></i><b>5.6</b> Adding a Dataseries to an Existing Plot</a></li>
<li class="chapter" data-level="5.7" data-path="data-visualization.html"><a href="data-visualization.html#annotating-a-plot"><i class="fa fa-check"></i><b>5.7</b> Annotating a Plot</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Excel for General Chemistry</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="math-stats-and-programming" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Section 4</span> Math, Stats, and Programming<a href="math-stats-and-programming.html#math-stats-and-programming" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Physical chemistry is a quantitative science, meaning we use mathematical operations to explain and explore chemical phenomena. This math can be done by hand, but once you have more than one or two data points this gets very tiring and a spreadsheet can be a lifesaver! In this section we will talk about how to program mathematical equations into Excel, how to use common mathematical and statistical functions, and how to reference other values within the spreadsheet. We will also dip our toes into some simple computer programming that can be very useful.</p>
<p>The first two subsection <a href="math-stats-and-programming.html#mathematical-operations">Mathematical Operations</a> and <a href="math-stats-and-programming.html#cell-referencing">Cell Referencing</a> use the air quality datasets from the NAPS network as examples. If you received a dataset through your CHM135 lab section feel free to use it to follow along. If not, you can visit the <a href="intro.html#intro">Introduction</a> page to download the example dataset used throughout this resource (note that you cannot use the example dataset for your analysis in CHM135).</p>
<div id="mathematical-operations" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Mathematical Operations<a href="math-stats-and-programming.html#mathematical-operations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As described in the <a href="intro.html#intro">Introduction</a>, atmospheric chemists have defined the term “odd oxygen” or O<sub>X</sub> as the sum of the concentrations of NO<sub>2</sub> and O<sub>3</sub>. <strong>To add O<sub>X</sub> to your analysis you will need to calculate the concentration O<sub>X</sub> at each timepoint</strong>. To do this, simply add the cells containing O<sub>3</sub> and NO<sub>2</sub> for the first timepoint (both concentrations are in ppb so they can be added directly) then copy this formula down the column. When you add a formula into Excel remember to start with an equals sign (“=”), this will let Excel know you are writing a formula. If you are referencing a cell you can either write it in (e.g. “C2”) or you can click on the cell. Once your formula is complete, hit ENTER and Excel will perform the calculation.</p>
<p>Excel can perform many mathematical operations and the table below provides a list of some of the most common with their corresponding formula.</p>
<table>
<colgroup>
<col width="19%" />
<col width="47%" />
<col width="16%" />
<col width="15%" />
<col width="2%" />
</colgroup>
<thead>
<tr class="header">
<th>Input</th>
<th>Operator</th>
<th>Example…</th>
<th>… solves to</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>=</td>
<td>Equal sign indicates a mathematical operation</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>+</td>
<td>Addition</td>
<td>=2+2</td>
<td>4</td>
<td></td>
</tr>
<tr class="odd">
<td>-</td>
<td>Subtraction</td>
<td>=3–2</td>
<td>1</td>
<td></td>
</tr>
<tr class="even">
<td>*</td>
<td>Multiplication</td>
<td>=3*2</td>
<td>6</td>
<td></td>
</tr>
<tr class="odd">
<td>/</td>
<td>Division</td>
<td>=4/2</td>
<td>2</td>
<td></td>
</tr>
<tr class="even">
<td>^</td>
<td>Exponent</td>
<td>=4^2</td>
<td>16</td>
<td></td>
</tr>
<tr class="odd">
<td>( )</td>
<td>Brackets to indicate order of operations</td>
<td>=(4+2)*2</td>
<td>12</td>
<td></td>
</tr>
<tr class="even">
<td>LOG(number,base)</td>
<td>Logarithm (10 is the default if no base is indicated)</td>
<td>=LOG(100,10)</td>
<td>2</td>
<td></td>
</tr>
<tr class="odd">
<td>LN(number)</td>
<td>Natural Logarithm</td>
<td>=LN(2)</td>
<td>0.693…</td>
<td></td>
</tr>
</tbody>
</table>
<p>To copy the formula from one cell down the list of data points, you can use the copy and paste function in the edit menu or the keyboard shortcuts CONTROL+C to copy and CONTROL+V to paste in Windows or COMMAND+C and COMMAND+V on a Mac. You can also use a shortcut specific to Excel. Click on the cell with your formula and notice the little square in the lower righthand corner. Click on this square and drag the formula down the column, or, even better, double click on the square and Excel will automatically paste the formula down the column until the end of the series (note that it will stop at the first blank cell so if you are missing values you may need to copy and paste the formula the rest of the way). <strong>When you add a new value, make sure you remember to label your column.</strong></p>
<p><img src="gifs/OxCalc.gif" /><!-- --></p>
<p>If you are learning about mathematical operations in Excel for the first time we strongly suggest reading the next section on cell referencing.</p>
</div>
<div id="cell-referencing" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Cell Referencing<a href="math-stats-and-programming.html#cell-referencing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of Excel’s strengths is its ability to easily perform mathematical operations in larger datasets. To take advantage of this feature it is important to appreciate how Excel references values in the spreadsheet. Simply referencing a cell in Excel will add a <strong>relative reference</strong>, which means that the reference will move as the equation is copied and pasted to other cells. This is the type of reference created in the O<sub>X</sub> calculation in the section above. If you are unsure of the cells being referenced in an equation Excel will visualize the reference when you click on the cell. To exit the function hit escape (ESC) on your keyboard.</p>
<p><img src="gifs/RelRef.gif" /><!-- --></p>
<p>A relative reference is very useful when calculating a series of numbers, however there are times when you might wish to make an <strong>absolute reference</strong>, such that it does not move as it is copied and pasted. To do this you add a $ in front of the letter and/or the number in the cell reference. It is possible to add a $ to only the letter (column reference) or the number (row reference) and only lock one aspect of the referencing or to lock both.</p>
<p>The gif below, which is a spreadsheet setup to calculate the energy of a photon in J/molecule from its wavelength in nm (if interested, download the example dataset <a href="./datasets/Relative_Referencing_Exercise.csv">here</a>), is an example that includes both absolute and relative references. The equation to calculate energy includes absolute references to the relevant constants and a relative reference to the wavelength of the photon such that it moves as the equation is copied down the column. As shown in the gif, if the absolute reference is not properly applied the calculated values don’t make any sense. A more complicated example of cell referencing is discussed in the <a href="math-stats-and-programming.html#if-statements">If Statements</a> section below.</p>
<p><img src="gifs/EnergyCalc.gif" /><!-- --></p>
</div>
<div id="spreadsheet-organization" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Spreadsheet Organization<a href="math-stats-and-programming.html#spreadsheet-organization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before moving on to more complicated functions in Excel <strong>it is useful to discuss ways of organizing a spreadsheet</strong>, particularly when planning to use cell references. In the example above, the constants were added to the top of the sheet so they could be easily incorporated into the calculation. A limitation of this organization is that it’s not possible to select entire columns using the letter column headers. <strong>If you decide to move your constants around, using the CUT and PASTE functions will preserve the cell reference</strong>. Cells can be CUT in Excel by selecting CUT from the dropdown menu that appears when you right click or using the keyboard shortcuts, CONTROL+X in Windows and COMMAND+X on a Mac. You can also add rows or columns to your sheet by selecting INSERT from the dropdown menu when you right click. The number of rows or columns added correspond to the number highlighted and the rows will be added above your selection and the columns to the left of your selection.</p>
<p><img src="gifs/CutPaste.gif" /><!-- --></p>
<p>There is no one right way to organize a spreadsheet, but when using values that need to be referenced or values that are calculated it is useful to plan their position in the sheet and to be able to move them if your original position isn’t optimal.</p>
</div>
<div id="simple-statistical-functions" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Simple Statistical Functions<a href="math-stats-and-programming.html#simple-statistical-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When we have several measurements it is often useful to know how they compare to one another. To get a sense of that we can employ some simple statistical functions. One such function is a mean or average value, given the symbol <span class="math inline">\(\overline{x}\)</span>. Another typical function is a standard deviation, given the symbol <span class="math inline">\(\sigma\)</span>. We typically understand what a mean value represents, but what is a standard deviation? The mathematical formula for the standard deviation of a set of values is shown in equation (<span class="math inline">\(\ref{eq8}\)</span>):</p>
<p><span class="math display">\[
\begin{align}
    \sigma = \sqrt{ \frac{\sum (x_i-\overline{x})^{2}}{N-1}} \label{eq8}\tag{8}
\end{align}
\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> is the individual data points within the dataset; <span class="math inline">\(\overline{x}\)</span> is the mean value of the dataset; and N is the number of values in the dataset. Looking at this formula it is clear that standard deviation is related to the difference between the individual values in the dataset and the mean value of the dataset. Standard deviation is a useful metric for appreciating the spread in the data. The greater the spread, the greater the standard deviation. More specifically, as shown in the figure below, one standard deviation away from the mean on either side will include 68% of the data points and two standard deviations will include 95% of the data.</p>
<center>
<img src="images/StandardDeviation.png" />
</center>
<p>Standard deviation is a useful metric. The magnitude of the spread in the data is often related to the overall magnitude of the values. For example, the standard deviation of 0.5 is large for a dataset with a mean value of 1, but small for a dataset with a mean value of 50. To provide this context the relative standard deviation (RSD) can be calculated by dividing the standard deviation by the mean value and then multiplying this ratio by 100 (equation (<span class="math inline">\(\ref{eq9}\)</span>).</p>
<p><span class="math display">\[
\begin{align}
    RSD = \frac{\sigma}{\overline{x}} \times 100 \label{eq9}\tag{9}
\end{align}
\]</span></p>
<p>The RSD of a dataset expresses the magnitude of the spread in the data using a percentage to normalize for differences in magnitude (e.g. a dataset with a mean value of 1 and a standard deviation of 0.5 has an RSD of 50%, and that with a mean value of 50 and a standard deviation of 0.5 has an RSD of 1%).</p>
<p>The table below presents formula and descriptions to calculate the mean, median, standard deviation, as well as the minimum and maximum values for a set of numbers.</p>
<table>
<colgroup>
<col width="25%" />
<col width="28%" />
<col width="43%" />
<col width="1%" />
<col width="1%" />
</colgroup>
<thead>
<tr class="header">
<th>Calculation</th>
<th>Formula</th>
<th>Description</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td>=AVERAGE(number1, [number2], …)</td>
<td>Returns the arithmetic mean of the inputs.</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Median</td>
<td>=MEDIAN(number1, [number2], …)</td>
<td>Returns the middle number in a group of supplied number.</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Standard Deviation</td>
<td>=STDEV(number1, [number2], …)</td>
<td>Returns the standard deviation of the samples provided.</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Minimum</td>
<td>=MIN(number1, [number2], …)</td>
<td>Returns the minimum value in a set of numbers.</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Maximum</td>
<td>=MAX(number1, [number2], …)</td>
<td>Returns the maximum value in a set of numbers.</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>The figure below provides some context on how to use these formulas with an example calculating the mean, median, standard deviation, relative standard deviation, minimum and maximum values of a list of outdoor summer temperatures in Toronto (if interested, download the example dataset <a href="./datasets/Temperature.csv">here</a>). The formula for each calculation is provided as text next to the value in question (note the quotation marks, which indicate to Excel that the contents of the cell should be treated as text). Keep in mind that Excel will help you with these calculations, once you put an equal sign into the equation bar and start typing it will give you suggestions of possible functions, don’t be afraid to use them. Once you select the function and the brackets are open you can also select one cell, or a series of cells, using the cursor as opposed to writing them in.</p>
<center>
<img src="images/SimpleStats.png" />
</center>
</div>
<div id="if-statements" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> If Statements<a href="math-stats-and-programming.html#if-statements" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that you have used some simple statistical functions in Excel, let’s explore some other functions and simple computer programming. The first function we will explore is the use of “if” statements. “if” is a conditional statement that signals to Excel that a decision will need to be made. As with the functions described in the <a href="math-stats-and-programming.html#simple-statistical-functions">Simple Statistical Functions</a> section, once you start the formula by writing “=i” into the formula bar Excel will provide you with many possible functions. Choose “IF”.</p>
<center>
<img src="images/ifstatement1.png" style="width:40.0%" />
</center>
<p>Once you choose the IF function, Excel will again help you by explaining what the function requires to operate, in this case a logical test and a result for when the test is true and for when it is false. As is typical in more sophisticated Excel programming, each of these requirements is separated by commas.</p>
<center>
<img src="images/ifstatement2.png" style="width:50.0%" />
</center>
<p>To see how the IF function can be applied, let’s imagine a scenario where a small cafe has four employees and needs to sort out the hours they have worked (if interested, download the example dataset <a href="./datasets/If_Statements.csv">here</a>). In this case the timekeeping software exports a ledger that indicates the employee, day, time, and number of hours they worked.</p>
<center>
<img src="images/Employees.png" />
</center>
<p>The cafe employer would like to sort this information so that they have a clear picture of the number of hours worked by each employee over the course of the week. To do this they create a column header that includes the employee’s names (Ayaan, Charlotte, Melena and Zambala) and then write IF statements for each that only add the number of hours into the column if the employee’s name is found in that row. As described above the IF always includes:</p>
<ul>
<li><p><strong>Logical Test:</strong> in this case, the logical test is asking whether the name in a given row matches the name at the top of the column (note the use of a relative reference for the name in the row and an absolute reference for the column header, details on referencing can be found in the <a href="math-stats-and-programming.html#cell-referencing">Cell Referencing</a> section).</p></li>
<li><p><strong>Value If True:</strong> here the formula selects the number of hours for the row being investigated as this is what we would like to display if that employee was the one to work these hours.</p></li>
<li><p><strong>Value If False:</strong> here the formula indicates the conditional statement should report a empty cell (indicated by the empty brackets ““) if the employee mentioned in this row does not match the name at the top of the column.</p></li>
</ul>
<p><img src="gifs/ifstatements.gif" /><!-- --></p>
<p>To copy this first IF statement to the remaining employees we could try to simply copy and paste the cell itself to the next column, but (as shown in the gif below, or if you try it yourself) this would move all the relative references and cause a mess. To address this we need to rethink the relative and absolute references used in the gif above. <strong>Before you go through the changes made below, challenge yourself to write out the changes you think would work by hand or work through it using the dataset provided.</strong></p>
<p>Here are the changes that need to be implemented so that the function can be copied across both columns and rows:</p>
<ul>
<li><p><strong>Logical Test:</strong> The reference to the employee name in column A needs an absolute reference on the column, so it doesn’t more as you copy the formula to the other columns, but a relative reference to the row so it moves as the formula is copy down the rows. Conversely the reference to the names in the column headers needs a relative reference on the column but an absolute reference on the row.</p></li>
<li><p><strong>Value If True:</strong> Similar to employee name in column A, hours worked in column E need an absolute reference on the column but a relative reference on the row.</p></li>
<li><p><strong>Value If False:</strong> No cell references here.</p></li>
</ul>
<p><img src="gifs/ifstatements2.gif" /><!-- --></p>
</div>
<div id="sum-and-count-functions" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> SUM and COUNT Functions<a href="math-stats-and-programming.html#sum-and-count-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Excel includes many useful functions, far too many to outline here. A couple of very useful functions are the the SUM and COUNT functions. As the name suggests, the SUM function returns the sum of a range of numbers. The COUNT function returns the number of values in the outlined range. Both of these functions can be combined with the IF function using the SUMIF and COUNTIF functions where values are summed or counted only if certain criteria are met. The AVERAGE function introduced in the <a href="math-stats-and-programming.html#simple-statistical-functions">Simple Statistical Functions</a> section can also be included with an IF statement using the AVERAGEIF function.</p>
<table>
<colgroup>
<col width="11%" />
<col width="32%" />
<col width="55%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Calculation</strong></th>
<th><strong>Formula</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sum</td>
<td>=SUM(number1, [number2], …)</td>
<td>Returns the sum of the inputs</td>
</tr>
<tr class="even">
<td>Sum If</td>
<td>=SUMIF(range, criteria, [sum_range])</td>
<td>Returns the sum of the inputs based on the outlined criteria</td>
</tr>
<tr class="odd">
<td>Count</td>
<td>=COUNT(value1, [value2], …)</td>
<td>Returns the number of values in the given range</td>
</tr>
<tr class="even">
<td>Count If</td>
<td>=COUNTIF(range, criteria)</td>
<td>Returns the number of values in the given range based on the outlined criteria</td>
</tr>
<tr class="odd">
<td>Mean If</td>
<td>=AVERAGEIF(range, criteria, [average_range])</td>
<td>Returns the arithmetic mean of the inputs based on the outlined criteria</td>
</tr>
</tbody>
</table>
<p>To explore these functions let’s take another look at the book-keeping exercise from the <a href="math-stats-and-programming.html#if-statements">If Statements</a> section. Imagine the hours for each employee need to be summed over the week. This can be accomplished using the SUM function. The number of shifts worked can also be determined using the COUNT function, and the average length of the shifts using the AVERAGE function.</p>
<p><img src="gifs/SumCount.gif" /><!-- --></p>
<p>The work flow outlined above is a two-step process that first uses an IF statement and then the SUM, COUNT and AVERAGE functions. This works perfectly well. The two functions can also be combined using the SUMIF, COUNTIF and AVERAGEIF functions. To accomplish this, select the range of values that will be used to judge the criteria, the criteria itself, and then the range to be summed, counted or averaged.</p>
<p><img src="gifs/SumCountIF.gif" /><!-- --></p>
</div>
<div id="slope-trendline-and-r2-functions" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> SLOPE, TRENDLINE and R<sup>2</sup> Functions<a href="math-stats-and-programming.html#slope-trendline-and-r2-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many variables in chemistry have a linear relationship and linear trendlines (with equation y=mx+b) are often used to describe these relationships mathematically. Trendlines can be added to scatterplots in Excel, and details on how to do this are provided in the [Linear Regression] and [Adding a Trendline] subsections of the <a href="data-visualization.html#data-visualization">Data visualization</a> section of this resource. <strong>If the equation of the linear trendline is required for subsequent calculations it is useful to calculate the slope (m) and intercept (b) in the body of the spreadsheet</strong> as opposed to simply reading them off of the graph. The functions used to do perform these calculations are provided in the table below.</p>
<table>
<colgroup>
<col width="11%" />
<col width="32%" />
<col width="55%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Calculation</strong></th>
<th><strong>Formula</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Slope</td>
<td>=SLOPE(known_ys, known_xs)</td>
<td>Returns the slope of the linear trendline</td>
</tr>
<tr class="even">
<td>Intercept</td>
<td>=INTERCEPT(known_ys, known_xs)</td>
<td>Returns the intercept of the linear trendline</td>
</tr>
<tr class="odd">
<td>R<sup>2</sup></td>
<td>=RSQ(known_ys, known_xs)</td>
<td>Returns the R<sup>2</sup> of the linear regression, which is a measure of how well the line predicts the variation observed in the data</td>
</tr>
</tbody>
</table>
<p>The GIF below provides an example executing</p>
<p>for details on how this is done on a graph in Excel is with a y = mx + b commonly with an equation R<sup>2</sup> value is a common are a common The SLOPE, TRENDLINE and R<sup>2</sup> functions allow you to calculate these</p>
<p>Another set of very useful functions in Excel is the ability to calculate the slope and intercept for a linear trendline within the equation of</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["excel4chem.pdf", "excel4chem.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
