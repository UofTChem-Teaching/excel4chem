[["index.html", "Excel for General Chemistry Preface Providing Feedback Authors Acknowlegements", " Excel for General Chemistry David Hall, David Liu, and Jessica D’eon Book last built on 2022-06-21 Preface Howdy, This website is more-or-less the living result of a collaborative project between us. We’re not trying to be an exhaustive resource for all chemists or courses. Rather, we’re focusing on developing broadly applicable data science course content (tutorials and recipes) based in Microsoft Excel for chemistry courses and research. This book will is broken up into … Providing Feedback If you notice an error, mistake or if you have suggestions for adding features or improving the book, please reach out to us or flag an issue on GitHub. Dave at davidross.hall@mail.utoronto.ca Jessica D’eon at jessica.deon@utoronto.ca Authors David Hall David Liu Jessica D’eon Acknowlegements Additionally, we would like to thank …. "],["intro.html", "Section 1 Introduction 1.1 Ozone is Not Our Friend 1.2 Atmospheric Concentration Units", " Section 1 Introduction Welcome to first year chemistry! This resource has been developed to guide you through the data analysis component of the first year labs and we hope the skills you learn will help you succeed in chemistry and beyond! The majority of this online resources uses air quality data collected by the Canadian government through Environment and Climate Change Canada’s National Air Pollution Surveillance (NAPS) program. NAPS has been operating since 1969, and has 286 stations across 203 communities. As a companion to this Excel resource we have also developed the CHM135: Exploring Air Quality Data App, which can be used to explore and visualize data across the country and to download a dataset to use in this activity. 1.1 Ozone is Not Our Friend As an introduction to the chemistry we will in this activity, watch this video, which describes some of the major chemical contributors to poor urban air quality. A transcript of the video can be downloaded here. Stratospheric ozone protects us from harmful UV radiation from the sun, but at ground-level it is toxic and high concentrations are often the cause of poor air quality days. The video explores the relationship between ozone (O3) and nitrogen dioxide (NO2), two important secondary pollutants whose relationship is described by reactions (\\(\\ref{eq1}\\)) to (\\(\\ref{eq3}\\)) below. These two pollutants will act as the basis for our discussion of air quality in this exercise. \\[ \\begin{align} NO_2 + h\\nu → NO + O &amp;&amp; \\label{eq1}\\tag{1} \\\\ O + O_2 → O_3 &amp;&amp; \\label{eq2}\\tag{2} \\\\ O_3 + NO → O_2 + NO_2 &amp;&amp; \\label{eq3}\\tag{3} \\end{align} \\] As mentioned in the video, the atmospheric concentrations of NO2 and O3 are related to one another. This relationship is so intimate that reporting the concentration of one without the other is of limited utility. To embrace this relationship, atmospheric chemists have defined the term “odd oxygen” or OX as the sum of the concentration of NO2 and O3 as shown in equation (\\(\\ref{eq4}\\)) below. (Note that in chemistry we denote the concentration of a chemical using a square bracket ‘[]’) \\[ \\begin{align} [O_3] + [NO_2] &amp;= [O_X] \\label{eq4}\\tag{4} \\end{align} \\] 1.2 Atmospheric Concentration Units The NAPS datasets report concentrations of NO2 and O3 in units of parts per billion or ppb. The “parts per” unit describes the ratio of a certain type of molecule or atom as compared to the total molecules or atoms present. A percentage is a “parts per” unit you may be familiar with, it is parts per hundred (pph). Molecular oxygen (O2) is 21% or 21 pph of our atmosphere (e.g. out of a total of one hundred molecules in the atmosphere 21 will be oxygen). \\[ \\begin{align} [O_2] &amp;= \\frac{n_{O_2}}{n_{total}} \\times 100 = 21 pph \\label{eq5}\\tag{5} \\end{align} \\] Carbon dioxide (CO2) is present at concentrations around 400 ppm (parts per million) in the current atmosphere (e.g., out of a total of one million molecules in the atmosphere 400 will be carbon dioxide). \\[ \\begin{align} [CO_2] &amp;= \\frac{n_{CO_2}}{n_{total}} \\times 10^6 = \\frac{400}{10^6} \\times 10^6 = 400 ppm \\label{eq6}\\tag{6} \\\\ [O_3] &amp;= \\frac{n_{O_3}}{n_{total}} \\times 10^9 = \\frac{80}{10^9} \\times 10^9 = 80 ppb \\label{eq7}\\tag{7} \\end{align} \\] Aside from percentage, these may be unusual concentration units to you, so why use them? The “parts per” units are relative units that are only related to the relative amount of certain molecules or atoms present, meaning they do not change with changes in density, something that is particularly useful in the atmosphere as the density of gas molecules decreases as you increase in altitude. The concentration of O2 is 21 pph at the ground and 21 pph at the summit of Everest at an altitude of 8.8 km. Concentration units such as molarity (M or mol/L), with which you are likely more familiar, are absolute concentration units that express the amount of a substance within a defined volume. The concentration of O2 in mol/L is not the same at ground-level as it is at the summit of Everest. "],["capabilities.html", "Section 2 Getting Setup for Success 2.1 Accessing the Microsoft Office Suite of Software 2.2 Managing your Files 2.3 Creating Professional Documents", " Section 2 Getting Setup for Success Like many things in life, putting in some organizational work at the start will pay off in increased efficiency later on. In this section we will talk briefly about how to access the software you need to complete the first year labs and university courses more generally. We will also address best practices in file management so you can work efficiently and be sure you can quickly and easily find the files you have been working on. Finally we will talk about some of the practicalities of making the CHM135 lab reports, such as uploading images into a word document and creating a PDF. Again, these are useful tools you will use throughout your university career and beyond. 2.1 Accessing the Microsoft Office Suite of Software First and foremost, you must have a working copy of both Microsoft Excel and Word. Current U of T students with a UTmail+ account can access this software for free, see this U of T libraries website for details: https://onesearch.library.utoronto.ca/ic-faq-categories/office-365-proplus. On this site you will see two access options, one is the typical desktop version where the software is downloaded and run on your local computer. This is the typical way to run this software and until recently was the only way. The second way to access this software is via the web interface where the software runs in a web browser. The web version of the software can be accessed via your UTmail+ account at mail.utoronto.ca, which will send you to the Microsoft Outlook web interface where you can find all the available apps by clicking on the app launcher (the 9 dots on the top left). There is no right or wrong way to access Microsoft Excel and Word in this experiment, in fact it might make sense to access your work in different ways depending on your situation. Maybe you use the desktop software on your personal computer and the web interface when on a shared computer on campus. How you access your files depends a lot on where they are saved, something that will be discussed in the next section. 2.2 Managing your Files In addition to the Microsoft Office software suite, current U of T students have access to OneDrive (top right app in Figure 1) which is an online file management system. We strongly suggest you use OneDrive to store and organize your files. Details on how to access OneDrive using the web interface, as well as how to sync OneDrive with your personal computer can be found here: https://onesearch.library.utoronto.ca/ic-faq-categories/onedrive. If you have a personal computer or laptop, syncing OneDrive with that computer is a great option as your files are available on your personal computer for offline work and are also always backed up and available online. Once you decide where you would like to save your work, it is important to organize this space so you can easily find files you have been working on. Here is an example for CHM135 where a folder for CHM135 has been created on OneDrive (and synced with a Mac laptop in this case). To further organize the content subfolders have been created for the class, tutorial, and lab components of the class and subfolders within the lab for each of the five experiments. 2.3 Creating Professional Documents Word processing is an important aspect of university education and there will come a time when you will need to produce professional documents in Microsoft Word that include images and are output as a PDF. As you are reading this resource about data analysis in Excel, it is likely that a graph or other data visualization from Excel is one of the images you would need to add to your word document, so let’s start there. 2.3.1 Adding an Excel Graph into a Word Document One way to add a graph in Excel to a document in Word is to simply copy and paste it. An interesting aspect of this approach is that the Excel graph is not an image file, but is still connected to the Excel file it came from and can be further manipulated and altered, as shown in the gif below. There is nothing wrong with this and if you have careful file management (meaning the Excel file doesn’t get moved or deleted or have its name changed) it works well. However, if you would like the content of the Word document not to be connected to the Excel file you can add the graph as an image. gif - copy and paste excel graph into word and click on aspects of the graph to show that it can still be editted The first step to adding an Excel graph as an image to a Word document is to the save the graph as an image. To do this select the graph with your cursor, right click and select Save as Image. Then you can save your graph in an appropriate location with an appropriate title. gif - save Excel graph to the 135 lab 1 folder with an appropriate name Now that you have a created an image of your graph you can add it anywhere you would like in your Word document. Simply place your cursor wherever you would like to add the image in the document and on the Insert menu select Pictures &gt; Pictures from File. Once the image is in your document you can alter its size and alignment. You can also change how the text interacts with the image, meaning is it in line with the text (in line), does the text go around on the side of the image (square), or is the image simply in front or behind the text (in front / behind). gif - add image to a word document, change its size, alignment and interaction with text 2.3.2 Creating a PDF from a Word Document Once you are done creating your word document the best way to disseminate it is to transform it into a PDF so the formatting or other aspects of the document remain intact. On the desktop version of Word you can create a PDF using the Save a Copy… function in the file menu. gif - save as PDF on desktop To create a PDF from the mobile version of Word choose file then Save as then Download as PDF. gif - save as PDF on mobile "],["data-wrangling.html", "Section 3 Data Wrangling 3.1 File Upload 3.2 Data Organization and Cell Formatting 3.3 Data Manipulation", " Section 3 Data Wrangling This guide is written for the first-year chemistry courses at the University of Toronto but would be useful for a variety of applications in academia and beyond. Working in the chemistry lab often involves the production and collection of data. When we collect data in the lab we often feel that any changes, or manipulations, to the data would be dishonest. However, the truth is that most data requires some manipulation as part of its analysis. In this section we will discuss how to import your data into Excel (if it’s not already in Excel), how to format it and how to make educated, and transparent, decisions related to data manipulation. 3.1 File Upload Many datasets (particularly larger ones) are stored as .csv files. The CSV file extension stands for comma-separate values file, a popular file format for storing data that you are bound to encounter again in your academic careers. As the name implies, CSV files contain data separated by commas. If you are interested, feel free to open your file in Notepad, TextEdit or Microsoft Word to see this organization. Excel can open CSV files and will typically automatically assign the comma-separated values into different columns. Once you open your .csv file using excel be sure to save it as an .xlsx file so that you can avail yourself of all of Excel’s features. It is also best practice that you keep a copy of the CSV file saved to your computer separate from the .xlsx file you will use for your analysis just in case something goes wrong and you need to start from scratch with a clean dataset. 3.2 Data Organization and Cell Formatting When you open a file in Excel notice how the values are arrayed in a table of cells, each containing a single value. These cells are arranged in columns with labelled headings (A, B, C, etc.) and rows (1, 2, 3, etc.). A single cell can be referenced using this system (i.e. in the gif above the cell “B3” contains the value “-20.6”). If you open the CSV file from the NAPS program you will see the data organized into four columns with the following headers: Date &amp; Time: This column indicates the day and time the air quality data was measured. Temperature: The ambient air temperature in degrees Celsius. NO2: The concentration of NO2 in the air in ppb. O3: The concentration of O3 in the air in ppb. The temperature and concentration values provided are hour-ending averages, meaning that when you see temperature or concentration for 1 AM, it is the average of the measured values between 12 AM and 1 AM that day. If any of your cells are not properly formatted, select these cells, then right click and select Format Cells… from the dropdown menu (you can also go to the Format menu and select Cells…). In the Format Cells dialog box you can see many formatting options, some of which are described in the table below. If your dataset includes a date you can format it so that it shows both the date and the time using the Custom category and the yyyy-mm-dd h:mm formatting option as shown below. You might have noticed that the date values in the gif above was initially written as a series of numbers, that is because Excel stores date values as the number of days since 1900-Jan-0, with a decimal value corresponding to the time of day. In the table below, 44005 days have passed since then, so Excel can interpret this as a date value. This relationship between numbers and dates can also go the other way when your numerical value may incorrectly be interpreted as a date. Just remember that the formatting only affects how the numbers are displayed, not the numbers themselves. Category Description Example General Has no specific format and so for numbers returns the full numerical value 44005 Number General display of numbers, can adjust the number of decimal places 44005.00 Scientific Displays numbers using scientific notations, can adjust the number of decimal places 4.40E+04 Date (long) A date format that gives day, month, year in full written notation Tuesday, June 23, 2020 Date (short) A date format that gives day, month, year in condensed notation 2020-06-23 Custom A date format that gives day, month, year as well as time of day that is useful for our needs in Experiment 1. 2020-06-23 0:00 3.3 Data Manipulation The word manipulation has a sinister connotation when referring to people, but in reference to data it is anything but. Data manipulation is the process of creating useful and meaningful datasets from which useful and meaningful information can be obtained. An example what and why of data manipulation can be found in the NAPS air quality datasets. If you create a timeseries for your NAPS data (detailed instructions provided in the Data Visualization chapter) you may see something similar to the plot shown below. Does anything stand out about this plot? Are there any outliers or points that differ significantly from the others? In this timeseries there are three points that are immediately suspicious. Our y-axis represents the concentration of either O3 or NO2, and three points have reported concentrations of about –1000 ppb, a physical impossibility. What is happening? It turns out this issue is programmed into the system, anytime there is any doubt in relation to a measurement taken by one of the instruments the system reports a value of -999. The use of -999 was done purposefully as it is immediately noticeable, unlike a missing value which could be misinterpreted as zero. Here is our first foray into data manipulation. It is clear the -999 values need to be removed, in fact they are meant to be removed, the question is how? Do we need to go through all 168 concentration values for each pollutant to find these outliers? Of course not! This is where we start to explore the functions and operations built into the spreadsheet software to do this work for us! The Find function in Excel is great way to look for these -999 values. As its name suggest, the Find function can help you find things in your spreadsheet. This function can be found in the Edit menu, but a convenient shortcut is the search bar at the top right of your Excel window. Type -999 into this window, hit ENTER, and see what happens. If you find any -999 values you should delete the entire row that includes this data as simply deleting the -999 value in the cell will lead Excel to treat it as a zero for any subsequent mathematical manipulations. To delete a row simply select it by clicking on the row number then right click and select DELETE. Take a minute to notice a few things in the gif above. When the search bar is used to find the -999 values it is important that no cells within the sheet are selected, if cells are selected Excel will only search the selected cells. Notice also that as the rows are deleted the plot updates automatically. This is useful when cleaning up the data, as in this example, but also when formatting the axes of your graph as the format of these values will follow the format in the selected cells (more details on this in the Data Visualization chapter). This the extent of data manipulation required for this dataset, but this idea of preparing our data for analysis is something we will return to throughout the first year chemistry labs and is something to reflect on as you complete any analysis. One thing to note before we leave this topic is the utility of visualizing your data when thinking about how to approach an analysis. The graph shown above is not pretty, the axes aren’t yet labelled, it doesn’t have an appropriate title, but it was useful as a first step in this analysis as it quickly and easily allowed us a snapshot of what was happening. "],["math-stats-and-programming.html", "Section 4 Math, Stats, and Programming 4.1 Mathematical Operations 4.2 Cell Referencing 4.3 Simple Statistical Functions 4.4 Useful Functions and Simple Programming 4.5 Troubleshooting", " Section 4 Math, Stats, and Programming Physical chemistry is a quantitative science, meaning we use mathematical operations to explain and explore chemical phenomena. This math can be done by hand, but once you have more than one or two data points this gets very tiring and a spreadsheet can be a lifesaver! In this section we will talk about how to program mathematical equations into Excel, how to use common mathematical and statistical functions, and how to reference other values within the spreadsheet. We will also dip our toes into some simple computer programming that can be very useful. 4.1 Mathematical Operations Excel can perform many mathematical operations and the table below provides a list of some of the most common with their corresponding formula. Input Operator Example… … solves to = Equal sign indicates a mathematical operation + Addition =2+2 4 - Subtraction =3–2 1 * Multiplication =3*2 6 / Division =4/2 2 ^ Exponent =4^2 16 ( ) Brackets to indicate order of operations =(4+2)*2 12 LOG(number,base) Logarithm (10 is the default if no base is indicated) =LOG(100,10) 2 LN(number) Natural Logarithm =LN(2) 0.693… Recall chemical equations (\\(\\ref{eq1}\\)) to (\\(\\ref{eq3}\\)) from the Introduction that describe the relationship between NO2 and O3. \\[ \\begin{align} NO_2 + h\\nu → NO + O &amp;&amp; \\label{eq1}\\tag{1} \\\\ O + O_2 → O_3 &amp;&amp; \\label{eq2}\\tag{2} \\\\ O_3 + NO → O_2 + NO_2 &amp;&amp; \\label{eq3}\\tag{3} \\end{align} \\] Also, recall that because these two pollutants are so intimately linked atmospheric chemists have defined a term called “odd oxygen” or OX that is the sum of NO2 and O3 at a given time point. \\[ \\begin{align} [O_3] + [NO_2] &amp;= [O_X] \\label{eq4}\\tag{4} \\end{align} \\] To add OX to your analysis you will need to calculate the concentration OX at each timepoint in your dataset. You can do this by simply adding the cells containing O3 and NO2 (both concentrations are in ppb so they can be added directly) for the first timepoint then copy this formula down the column. When you add a formula into Excel remember to start with a “=” sign (this will let Excel know you are writing a formula), if you are referencing a cell you can either write it in (e.g. “C2”) or you can click on the cell. Once your formula is complete, hit ENTER and Excel will perform the calculation. To copy the formula from one cell down the list of data points, you can use the copy and paste function in the edit menu or the keyboard shortcuts, CONTROL+C to copy and CONTROL+V to paste (COMMAND+C and COMMAND+V on a Mac). You can also use a shortcut specific to Excel. Click on the cell with your formula and notice the little square in the lower righthand corner. Click on this square and drag the formula down the column, or, even better, double click on the square and Excel will automatically paste the formula down the column until the end of the series (note that it will stop at the first blank cell so if you are missing values you may need to copy and paste the formula the rest of the way). When you add a new value, make sure you remember to label your column. If you are learning about mathematical operations in Excel for the first time we strongly suggest reading the next section on cell referencing. 4.2 Cell Referencing One of Excel’s strengths is its ability to easily perform mathematical operations in larger datasets. To take advantage of this feature it is important to appreciate how Excel references values in the spreadsheet. Simply referencing a cell in Excel will add a relative reference, which means that the reference will move as the equation is copied and pasted to other cells. This is the type of reference created in the OX calculation in the section above. If you are unsure of the cells being referenced in an equation Excel will visualize the reference when you click on the cell. A relative reference is very useful when calculating a series of numbers, like OX from O3 and NO2, however there are times when you might wish to make an absolute reference, such that it does not move as it is copied and pasted. To do this you add a $ in front of the letter and/or the number in the cell reference. It is possible to add a $ to only the letter (column reference) or the number (row reference) and only lock one aspect of the referencing or to lock both. The gif below, which is a spreadsheet setup to calculate the energy of a photon in J/molecule from its wavelength in nm, is an example that includes both absolute and relative references. The equation to calculate energy includes absolute references to the relevant constants and a relative reference to the wavelength of the photon such that it moves as the equation is copied down the column. As shown in the gif, if the absolute reference is not properly applied the calculated values don’t make any sense. 4.3 Simple Statistical Functions When we have several measurements it is often useful to know how they compare to one another. To get a sense of that we can employ some simple statistical functions. One such function is a mean or average value, given the symbol \\(\\overline{x}\\). Another typical function is a standard deviation, given the symbol \\(\\sigma\\). We typically understand what a mean value represents, but what is a standard deviation? The mathematical formula for the standard deviation of a set of values is shown in equation (4.1): \\[\\begin{equation} \\sum \\frac{\\left(x-\\overline{x}\\right)^{2}}{N-1} \\tag{4.1} \\end{equation}\\] where \\(\\x_i\\) is the individual data points within the dataset; \\(\\overline{x}\\) is the mean value of the dataset; and N is the number of values in the dataset. Looking at this formula it is clear that standard deviation is related to the difference between the individual values in the dataset and the mean value of the dataset. Standard deviation is a useful metric for appreciating the spread in the data. The greater the spread, the greater the standard deviation. More specifically, as shown in the figure below, one standard deviation away from the mean on either side will include 68% of the data points and two standard deviations will include 95% of the data. Standard deviation is a useful metric, however the magnitude of the spread in the data is often related to the overall magnitude of the values. For example, the standard deviation of 0.5 is large for a dataset with a mean value of 1, but small for a dataset with a mean value of 50. To provide this context we can calculate a relative standard deviation (RSD), which is calculated by dividing the standard deviation by the mean value and then multiplying this ratio by 100 (equation (4.1)). \\[\\begin{equation} RSD = \\frac{\\sigma}{\\overline{x}} \\times 100 \\tag{4.1} \\end{equation}\\] The RSD of a dataset expresses the magnitude of the spread in the data using a percentage to normalize for differences in magnitude (e.g. a dataset with a mean value of 1 and a standard deviation of 0.5 has an RSD of 50%, and that with a mean value of 50 and a standard deviation of 0.5 has an RSD of 1%). The table below presents formula and descriptions to calculate the mean, median, standard deviation, as well as the minimum and maximum values for a set of numbers. Calculation Formula Description Mean =AVERAGE(number1, [number2], …) Returns the arithmetic mean of the inputs. Median =MEDIAN(number1, [number2], …) Returns the middle number in a group of supplied number. Standard Deviation =STDEV(number1, [number2], …) Returns the standard deviation of the samples provided. Minimum =MIN(number1, [number2], …) Returns the minimum value in a set of numbers. Maximum =MAX(number1, [number2], …) Returns the maximum value in a set of numbers. The figure below provides some context on how to use these formulas with an example calculating the mean, median, standard deviation, relative standard deviation, minimum and maximum values of a list of outdoor summer temperatures in Toronto. The formula for each calculation is provided as text next to the value in question (note the quotation marks). Keep in mind that Excel will help you with these calculations, once you put an equal sign into the equation bar and start typing it will give you suggestions of possible functions, don’t be afraid to use them. Once you select the function and the brackets are open you can also select one cell, or a series of cells, using the cursor as opposed to writing them in. 4.4 Useful Functions and Simple Programming details on if statements details on calculating the slope and intercept in the excel spreadsheet 4.5 Troubleshooting maybe some notes on common errors and how to approach troubleshooting might be useful to mention what an #N/A is and div0 "],["data-visualization.html", "Section 5 Data Visualization 5.1 Creating a Scatterplot 5.2 Changing Chart Type or Design 5.3 Adding Axis Labels and a Chart Title 5.4 Formatting Axis Labels 5.5 Adding a Data Series to an Existing Plot 5.6 Linear Regression 5.7 Adding a Trendling", " Section 5 Data Visualization Visualizing data is one of the most powerful ways to explore relationships and trends between variables. Visualizations are also a powerful way to communicate these relationships. In this section we will discuss the creation of the most common type of plot in chemistry: the scatterplot. How to make changes to a plot, how to add and format axes labels and how to add trendlines. 5.1 Creating a Scatterplot Data collected in a chemistry lab is typically discrete, meaning each point is an individual measurement. With this in mind, the most common type of plot used to explore data in the chemistry lab is a scatterplot, which plots each data point independently on the grid space of the graph. To create a scatterplot, select the columns of data you want to visualize and then go to the INSERT ribbon and select CHARTS, then SCATTER, then SCATTER again (this selection may look like a button with a picture of a little scatterplot). Alternatively, you can select the INSERT tab, then CHARTS, then X Y (Scatter). If you would like to make a plot with more than 1 dataset included, as in the gif above, then you can select all of the columns in question and create the scatterplot as described. Note that, as shown in the gif above, you can select an entire column by clicking on the column heading (e.g. clicking on ‘A’ will select all the data in column ‘A’). If you need to select columns that are not directly adjacent to one another hold the CTRL button (or COMMAND on a Mac) and click on the column headings you wish to select. The first thing to do once you make a plot is to simply look at it. Are the correct values plotted on the correct axes? Are the values properly formatted? Here is the plot that resulted from the gif above. What do you think? Although this figure is a bit difficult to read, from the flow of the points it looks as though the date and time is plotted on the x-axis and concentration on the y-axis. If you haven’t removed any -999 values in your dataset you might see some outlier values. If this is the case the Data Manipulation section walks you through how to remove them. 5.2 Changing Chart Type or Design As mentioned above, scatterplots are the most common type of plot in the chemistry lab as the data collected is discrete. However, as is often the case, rules were meant to be broken and although the timeseries data is discrete, adding a continuous smooth line will make relationships between the variables much easier to visualize, so let’s go ahead and do that. In addition to making the timeseries plot clearer, adding a smooth line will also allow us to practice changing a chart type after a plot has been generated. To do this click on the plot, then select the CHART DESIGN ribbon, then CHANGE CHART TYPE, then X Y (Scatter), then SCATTER WITH SMOOTH LINES (note that the last menu often appears as pictures of plots and so choose the one with a smooth line). This is also the menu you would choose if you wanted to change the chart type to visualize your data in another way (e.g. bar chart). 5.3 Adding Axis Labels and a Chart Title Once you have confirmed your graph is appropriate you will need to add axes titles. To do this, click on the plot, then click on the CHART DESIGN ribbon, then ADD CHART ELEMENT, then AXIS TITLES and add titles to both the x-axis (PRIMARY HORIZONTAL) and y-axis (PRIMARY VERTICAL). Once the axes titles are present, you can edit them to an appropriate label and remember to include units if relevant. A chart title is typically added automatically, but if not, the ADD CHART ELEMENT menu is also where you can find the CHART TITLE menu. Once the title is present you can edit it. Note that the addition of subscript or superscript text to an Excel chart title or axis label will require that you select the text in question, right click on it, select Font…, and then select the change you want. 5.4 Formatting Axis Labels Looking at the graph we are building in this section it is obvious that the x-axis is not properly formatted. To format an axis (in this case the x-axis), double click the axis values to reveal the FORMAT AXIS option panel that includes two tabs AXIS OPTIONS and TEXT OPTIONS. Here you have many options to explore. The dates on the x-axis of this timeseries are about as complicated as you will encounter where a simple adjustment of font size is not enough. There are two ways to approach adjusting the date and time displayed on the x-axis: adjust the spacing of the major and minor units within the AXIS OPTIONS tab; or adjust how the text is displayed in the TEXT OPTIONS tab. We will explore both options here. The major and minor units of the x-axis can be adjusted in the AXIS OPTIONS tab of the FORMAT AXIS panel. In the plot we are working on, the major unit was set to 1 (meaning every day is displayed) and the minor unit to 0.2. In this case the major unit corresponds to a gridline and a value displayed on the x-axis, while the minor unit is not displayed. Try changing these to something larger so that the date values are more spaced out. In the gif below the major unit was changed 2 and then to 3 and minor unit to 1. One of the consequences of changing the major and minor units of the x-axis is that it may change the bounds of the plot. To adjust this, the MINIMUM and MAXIMUM values of the axis can be adjusted in the BOUNDS menu of the AXIS OPTIONS tab to reflect the 7 days in your dataset. Remember that Excel stores date and time values using numerical values (see the Data Wrangling section for more details). To adjust the bounds, add or subtract integer values (i.e. 1, 2, 3) to the minimum and maximum until your data is properly framed. Notice how changes made in the MINIMUM and MAXIMUM values of the axis update as soon as you click elsewhere, this is useful when playing around to find the proper framing for the data. To adjust the x-axis by changing the direction of the text, select the TEXT OPTIONS tab of the FORMAT AXIS panel, find the TEXT BOX options box and change the angle of the text either by selecting an option such as ROTATED 90o from the TEXT DIRECTION menu or changing the value in the CUSTOM ANGLE box. One final note about axis formatting is that you may want to change how the values themselves are formatted (for example you may only want to see the date values and not the time in your timeseries). Remember that the values displayed in the graph are tied to specific values in your Excel sheet, and so any adjustments made to the values in the sheet will be reflected in the graph. 5.5 Adding a Data Series to an Existing Plot In the example above all of the data is ready to plot, but that’s not always the case. If we pretend that the plot was made before the OX values were calculated we can then add them in after the fact. In the gif below the OX data series is deleted and then re-added. To add data to a plot right click on the plot and click SELECT DATA from the dropdown menu (or go to the CHART DESIGN ribbon and click SELECT DATA). In the SELECT DATA SOURCE dialog box you should see the two data series already on your plot for NO2 and O3. Directly above this list, click ADD (on Mac select “+” directly below the list) and the EDIT SERIES dialog box will open, which includes three boxes entitled SERIES NAME:, SERIES X VALUES: and SERIES Y VALUES: (on Mac no new dialog box will open, but a data series will be added to the list and the boxes NAME:, X VALUES: and Y VALUES: will become available). To input information into these three boxes you can type directly into the box or click the arrow (on Mac this looks more like a little Excel sheet) to select data from your Excel sheet. The SERIES NAME: box is what your dataset will be referred to in the chart legend. You can type “Ox” directly in the box, or you can select the column header (the latter may be preferable as any changes to the table header will be applied immediately to the plot). To select data for the OX series, click on the arrows next to the SERIES X VALUES: and SERIES Y VALUES: and input the relevant data. For the x-values select the Data &amp; Time data and for the y-values select the calculate OX values (don’t include the headers). 5.6 Linear Regression To explore the relationship between O3 and NO2 you can create a correlation plot, which is a plot of one variable versus another, in this case O3 versus NO2. A robust statistical analysis of the correlation between O3 and NO2 is beyond the purview of this course. However, the correlation plot will help us better visualize the relationship between the two variables, which will improve our understanding of the factors affecting urban air quality and the chemistry taking place. First, create a scatter plot as described above, but this time the x-axis will correspond to the concentration of NO2 and the y-axis to the concentration O3. Then to assess if there is any correlation between the two pollutants, we’ll perform a linear least squares regression analysis. Linear refers to the fact that the relationship can be expressed as a straight line defined by the equation y = mx + b. Least squares means that the trendline is the best approximation of the given dataset, while still being a straight line. Lastly, the term regression means we’re going to estimate the relationship between two variables. Excel calculates the linear least squares regression trendline by minimizing the vertical distance (squares) between every actual value and its predicted value on the trendline. For example, in the figure below, the two lines (black and green) are both linear, but the black line is a better trendline as the sum of the squared distances between the points (the length of the arrows) is less than the green line. It’s important to remember that the ideal trendline may be farther from individual points than others (it might not touch any points at all), but the summed distance is the shortest. 5.7 Adding a Trendling To perform a linear regression analysis on your correlation plot between NO2 and O3, you will need to include a linear trendline. To do this right click on any of the data points in your plot and select ADD TRENDLINE from the dropdown menu. In the FORMAT TRENDLINE panel select LINEAR trendline, and then select DISPLAY EQUATION ON CHART and DISPLAY R-SQUARED VALUE ON CHART. Your plot should now resemble Figure 8 (but obviously with different data, as the data in this plot is from Tyler Vigen’s collection of spurious Correlations). The R2 value of the linear regression is a measure of how well the line predicts the variation observed in the data, and it can be summarized by equation 10. add equation The closer R2 is to 1, the better the regression line describes the relationship between the two variables (aka the closer the line is to every plotted point). Another way to think of it is if R2 = 1, 100% of the variation is explained by the linear model. The R2 of a trendline is a useful value, but it is only describing the variance in the data, and so a higher R2 does not prove the correlation between two variables just as a low R2 does not disprove it. The data shown in the gif above has a positive relationship. Between the years 2000 and 2009, the number of computer science PhDs graduating in the United States increased and so did the revenues from arcades. This is a positive correlation as the two variables increase or decrease together. This is evident visually and in the positive value of the slope of the trendline. Variables are negatively correlated when one increases the other decreases, in which case the slope of the trendline would be negative. Does the observed correlation between arcade revenues and computer sciences PhDs mean one variable caused the other (causation)? Maybe, maybe not. It’s not possible to answer this question using this plot alone, but the correlation observed between the two variables suggests the relationship may warrant further investigation. "],["bookdown-capabilities.html", "Section 6 Bookdown Capabilities 6.1 Interactive and exportable tables 6.2 Animated GIFS 6.3 Embedded videos 6.4 Jessica Test, Woo hoo! 6.5 Cross-referencing with bookdown.", " Section 6 Bookdown Capabilities Here are some examples of what we can do with bookdown and hosting online vs. a traditional Word/PDF document. 6.1 Interactive and exportable tables We can easily host example data online and have students export it directly using the csv button (top left). This will mimic Lab 1. ## # A tibble: 6 × 4 ## NAPS Time O3 NO2 ## &lt;dbl&gt; &lt;dttm&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 60435 2019-01-01 00:00:00 8 10 ## 2 60435 2019-01-01 01:00:00 5 14 ## 3 60435 2019-01-01 02:00:00 9 8 ## 4 60435 2019-01-01 03:00:00 12 6 ## 5 60435 2019-01-01 04:00:00 13 7 ## 6 60435 2019-01-01 05:00:00 17 5 We can also make it even easier to directly copy the table for smaller example data sets. Student’s can just paste into excel and work along with the chapter. 6.2 Animated GIFS We can readily record gifs of our Excel operations, and embedded them directly into the bookdown book. For the example below, I used LICEcap. It’s lightweight, and does exactly what I wanted it to. 6.3 Embedded videos And lastly, we can readily embed videos directly on the webpage. Based on the video below, if CHM135 students could have used their excel skills to close major business dealings in 1992… 6.4 Jessica Test, Woo hoo! Really looking forward to the textbook coming together! Otter Baby 6.5 Cross-referencing with bookdown. \\[\\begin{equation} J(A,U) = \\frac{|A ~ \\cap ~ B|}{|A ~ \\cup ~ B|} \\tag{4.1} \\end{equation}\\] Figure 6.1: You can only reference a figure if it has a caption Figure 6.2: You can only reference images if they’re in a captioned R code chunk. hyperlink to section like this Embedded videos labelled sections 6.5 equations (4.1) plots 6.1 images 6.2 The above links all reference to somethign on the same page, but they apply to anything across the entire document (as long as they’re being knit together). if you see ?? in your output, it means the reference you’re refering too doesn’t exist. Check the warning to see which one(s) it is. Some more tips for references: labels can’t start with a number, so plot-1 is good but 1-plot isn’t. Equations must start with the prefix eq, so eq:ideal-gas is good, but ideal-gas isn’t neither is ideal gas (note space), use hypens or underscores if you need to. Figures from code chunks are labelled by the first word proceeding the r in the code chunk. So starting your code chunk with ```{r plot-cars, ...} means the resulting code chunk is labelled as plot-cars. note you can’t have duplicate code chunks, this will throw an error. plots are only references when you have a caption. For image captions you need to put them in a code chunk and use knitr::include_graphics(...) to output your image/gif. Same labelling rules apply as for figures. You can read more on cross-referecing in Section 2.6 Cross-references in the Bookdown guide. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
